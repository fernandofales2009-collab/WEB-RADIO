<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üéµ Player Playlist Loop</title>
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #0d0d0d;
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      overflow: hidden;
    }
    h1 {
      margin-bottom: 30px;
      font-size: 2rem;
      letter-spacing: 1px;
    }
    #player-container {
      background: #1a1a1a;
      padding: 30px 40px;
      border-radius: 20px;
      box-shadow: 0 0 30px rgba(0, 255, 150, 0.2);
      text-align: center;
      max-width: 400px;
      width: 90%;
    }
    #current-track {
      font-size: 1.2rem;
      margin-bottom: 20px;
      color: #00ff99;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    audio {
      display: none;
    }
    .controls {
      display: flex;
      justify-content: center;
      margin-top: 20px;
    }
    .controls button {
      background: #00ff99;
      border: none;
      border-radius: 50%;
      width: 80px;
      height: 80px;
      font-size: 2rem;
      cursor: pointer;
      transition: .2s;
      color: #111;
      box-shadow: 0 0 25px rgba(0, 255, 150, 0.4);
    }
    .controls button:hover {
      transform: scale(1.1);
      box-shadow: 0 0 30px rgba(0, 255, 150, 0.6);
    }
    #vu-container {
      display: flex;
      justify-content: center;
      margin-top: 30px;
      height: 60px;
      align-items: flex-end;
    }
    .led {
      width: 6px;
      height: 100%;
      margin: 0 2px;
      background: #004400;
      border-radius: 2px;
      transition: height .05s, background .05s;
    }
  </style>
</head>
<body>
  <h1>üéµ Player Playlist Loop</h1>

  <div id="player-container">
    <p id="current-track">Nenhuma m√∫sica carregada</p>
    <audio id="player"></audio>
    <div class="controls">
      <button id="play-btn">‚ñ∂Ô∏è</button>
    </div>
    <div id="vu-container"></div>
  </div>

  <script>
    // Lista de URLs de arquivos de √°udio
    // IMPORTANTE: Por quest√µes de seguran√ßa, os navegadores n√£o permitem
    // acessar arquivos locais (do seu computador). Voc√™ deve usar URLs
    // de arquivos que estejam hospedados em algum lugar.
    // Substitua estas URLs pelas suas.
    const musicas = [
      "https://github.com/fernandofalesgomes/WEB-RADIO/raw/refs/heads/main/00%20-%20ELETRONICA%20BRITO%20-%20ELETRONICA%20BRITO%20CARIMBO%2002.aac",
      "https://github.com/fernandofalesgomes/WEB-RADIO/raw/refs/heads/main/00%20-%20aac%20-%20TRILHAS%20ESPORTIVAS%20NOVAS%20(4).aac",
      "https://github.com/fernandofalesgomes/WEB-RADIO/raw/refs/heads/main/00%20-%20ELETRONICA%20BRITO%20-%20ELETRONICA%20BRITO%20CARIMBO%2001.aac",
    ];

    let index = 0;
    const player = document.getElementById("player");
    const playBtn = document.getElementById("play-btn");
    const currentTrackName = document.getElementById("current-track");
    let isPlaying = false;
    let audioContext, analyser, source, dataArray;

    function initAudioContext() {
      // Inicia o AudioContext ap√≥s o primeiro clique do usu√°rio
      // para evitar problemas com pol√≠ticas de autoplay do navegador.
      if (!audioContext) {
        audioContext = new (window.AudioContext || window.webkitAudioContext)();
        analyser = audioContext.createAnalyser();
        // Aumenta a suavidade da anima√ß√£o do VU meter
        analyser.smoothingTimeConstant = 0.8;
        analyser.fftSize = 64;
        source = audioContext.createMediaElementSource(player);
        source.connect(analyser);
        analyser.connect(audioContext.destination);
        dataArray = new Uint8Array(analyser.frequencyBinCount);
        createVUMeter();
        animateVUMeter();
      }
    }

    function loadTrack() {
      if (musicas.length === 0) {
        currentTrackName.textContent = "Playlist vazia";
        return;
      }
      
      const musicaAtual = musicas[index];
      player.src = musicaAtual;
      
      // Atualiza o nome da m√∫sica na tela
      const nomeArquivo = musicaAtual.split('/').pop();
      currentTrackName.textContent = decodeURIComponent(nomeArquivo);

      player.load();
      player.play().catch(() => {
        // Se o navegador bloquear o autoplay, o usu√°rio precisa interagir
        console.log("Clique no bot√£o Play para iniciar a m√∫sica.");
      });
      isPlaying = true;
      playBtn.textContent = "‚è∏Ô∏è";
    }

    function togglePlay() {
      if (isPlaying) {
        player.pause();
        playBtn.textContent = "‚ñ∂Ô∏è";
      } else {
        player.play();
        playBtn.textContent = "‚è∏Ô∏è";
      }
      isPlaying = !isPlaying;
    }

    // Loop infinito da playlist
    player.addEventListener("ended", () => {
      index = (index + 1) % musicas.length;
      loadTrack();
    });

    // Inicia a primeira faixa e o contexto de √°udio apenas ap√≥s o primeiro clique
    playBtn.addEventListener("click", () => {
      initAudioContext();
      if (!isPlaying) {
        loadTrack();
      } else {
        togglePlay();
      }
    });

    // --- VU meter ---
    const NUM_LEDS = 20;
    const vuContainer = document.getElementById("vu-container");
    const leds = [];
    
    function createVUMeter() {
      for (let i = 0; i < NUM_LEDS; i++) {
        const div = document.createElement("div");
        div.className = "led";
        vuContainer.appendChild(div);
        leds.push(div);
      }
    }

    function animateVUMeter() {
      // Pega os dados de frequ√™ncia do analisador
      analyser.getByteFrequencyData(dataArray);

      // Mapeia os dados para a altura e cor dos LEDs
      for (let i = 0; i < NUM_LEDS; i++) {
        const value = dataArray[i] / 255.0; // Normaliza o valor entre 0 e 1
        let height = value * 100;
        
        // Define a cor baseada na intensidade
        let color = "#004400"; // Verde escuro para LED desligado
        if (value > 0.05) color = "#00ff99"; // Verde claro
        if (value > 0.5) color = "#ffcc00"; // Amarelo
        if (value > 0.8) color = "#ff0000"; // Vermelho

        leds[i].style.height = `${height}%`;
        leds[i].style.background = color;
      }

      // Chama a fun√ß√£o novamente na pr√≥xima renderiza√ß√£o do frame
      requestAnimationFrame(animateVUMeter);
    }
  </script>
</body>
</html>


