<audio id="player" controls></audio>

<script>
  async function carregarPlaylist() {
    try {
      // força sempre buscar versão nova do JSON
      const url = "playlist.json?v=" + new Date().getTime();
      const resposta = await fetch(url);
      const playlist = await resposta.json();
      console.log("Playlist carregada:", playlist);
      tocarPlaylist(playlist);
    } catch (e) {
      console.error("Erro ao carregar playlist:", e);
    }
  }

  function tocarPlaylist(playlist) {
    let index = 0;
    const audio = document.getElementById("player");

    function tocarMusica() {
      audio.src = playlist[index].url;
      audio.play();
    }

    tocarMusica();

    audio.onended = function () {
      index++;
      if (index >= playlist.length) {
        index = 0; // volta para a primeira música
      }
      tocarMusica();
    };
  }

  carregarPlaylist();
</script>
